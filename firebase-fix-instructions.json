{
  "rules_note": "These are the CORRECTED Firebase Firestore Security Rules to deploy to your Firebase console",
  "rules_content": "rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    match /tasks/{taskId} {\n      allow read: if request.auth != null && resource.data.userId == request.auth.uid;\n      allow create: if request.auth != null && request.resource.data.userId == request.auth.uid;\n      allow update, delete: if request.auth != null && resource.data.userId == request.auth.uid;\n    }\n    match /archive/{archiveId} {\n      allow read: if request.auth != null && resource.data.userId == request.auth.uid;\n      allow create: if request.auth != null && request.resource.data.userId == request.auth.uid;\n      allow update, delete: if request.auth != null && resource.data.userId == request.auth.uid;\n    }\n    match /users/{userId} {\n      allow read, write: if request.auth != null && request.auth.uid == userId;\n    }\n  }\n}",
  "deployment_instructions": [
    "1. Go to https://console.firebase.google.com/",
    "2. Select your project (pass-f417f)",
    "3. Go to Firestore Database",
    "4. Go to Rules tab", 
    "5. Copy the rules_content above and paste it",
    "6. Publish the rules"
  ],
  "fixes_applied": [
    "Fixed query to avoid composite index requirement",
    "Added proper order field calculation",
    "Fixed security rules for document creation vs reading"
  ]
}